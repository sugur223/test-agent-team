name: "ğŸ“¢ Notify: Approved"

on:
  pull_request_review:
    types: [submitted]

jobs:
  notify:
    if: |
      github.event.review.state == 'approved' &&
      contains(github.event.pull_request.labels.*.name, 'auto-dev')
    runs-on: ubuntu-latest

    steps:
      - name: Comment on PR
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          gh pr comment ${{ github.event.pull_request.number }} \
            --body "âœ… **è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†ãƒ»æ‰¿èªæ¸ˆã¿**

          @${{ github.event.pull_request.user.login }} ãƒãƒ¼ã‚¸å¯èƒ½ã§ã™ã€‚ç¢ºèªã—ã¦ãƒãƒ¼ã‚¸ã—ã¦ãã ã•ã„ã€‚

          ---
          ğŸ¤– è‡ªå‹•é–‹ç™ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ by Claude Code Ã— Codex"

      - name: Notify via Slack
        if: ${{ secrets.SLACK_WEBHOOK != '' }}
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
        run: |
          curl -s -X POST "$SLACK_WEBHOOK" \
            -H 'Content-Type: application/json' \
            -d "{
              \"text\": \"âœ… è‡ªå‹•å®Ÿè£…PRãŒæ‰¿èªã•ã‚Œã¾ã—ãŸ\n*${{ github.event.pull_request.title }}*\n${{ github.event.pull_request.html_url }}\"
            }"
